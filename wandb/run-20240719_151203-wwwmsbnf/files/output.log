max batch tokens: 8100
peak mem per batch: 10.6787109375 GB
Batch creation time: 66.6349 ms
torch.Size([3, 100, 56]) torch.Size([3, 100, 4])
cost_bbox shape: torch.Size([300, 200])
cost_class shape: torch.Size([300, 12])
cost_giou shape: torch.Size([300, 200])
Traceback (most recent call last):
  File "/Users/minjunes/vlm/train.py", line 311, in <module>
    loss_dict = criterion(outs, targets)
  File "/Users/minjunes/miniconda3/envs/vlm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/minjunes/miniconda3/envs/vlm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/minjunes/vlm/detr/models/detr.py", line 225, in forward
    indices = self.matcher(outputs_without_aux, targets)
  File "/Users/minjunes/miniconda3/envs/vlm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/minjunes/miniconda3/envs/vlm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/minjunes/miniconda3/envs/vlm/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/Users/minjunes/vlm/detr/models/matcher.py", line 85, in forward
    raise ValueError(f"Incompatible shapes: cost_bbox {cost_bbox.shape}, cost_class {cost_class.shape}, cost_giou {cost_giou.shape}")
ValueError: Incompatible shapes: cost_bbox torch.Size([300, 200]), cost_class torch.Size([300, 12]), cost_giou torch.Size([300, 200])